# Сервис подбора матчей (Matchmaking Service)

## Что делает ? 
Сервис запускается и динамически собирает игроков в комнаты по 3-м параметрам
 + Skill - уровень игры игрока 
 + Latency - задержка игрока 
 + Время ожидания в очереди

### По пунктам: 
1. На HTTP ручку **/v1/users/** поступает новый запрос пользователя 
2. Запрос валидируется 
3. После чего в отдельной горутине передается матчмейкеру  
    + Матчмейкер пробует найти группу для пользователя среди существующих групп 
    + Если группа есть, то пользователь добавляется туда 
    + Если группа достигла предельного размера группа выводится на экран
    + Группа удаляется
    + Если подходящей группы нет матчмеййкер создает новую группу и добавляет туда пользователя  
4. Данные пользователя передаются в Storage 

### Какие ручки есть на HTTP ?
На HTTP реализованы два обработчика:
1. POST **/v1/users** - добавляет пользователя к поиску группы 
2. GET **/v1/users/list** - отдает всех пользователей сохраненных в Storage
## Как запустить?  Просто ! 
### Варианта запуск есть четыре 
1. Запуск при помощи докер контейнера

В корне проекта выполните: 
```shell
docker build -tag "mm-service:latest" .
docker run mm-service 
```  

2. Запуск при помощи docker-compose.yml 

В корне проекта выполните: 
```shell
docker-compose up
```

3. Запуск средствам через терминал 

Для начала нужно скомпилировать бинарный файл 
```shell
go build -o mm-service .
```
а далее его можно запустить вот так: 
```shell
./mm-service
```

4. Запуск в интерактивной среде golang 
```shell
go run . 
```

## Что еще есть ? 
### Benchmarks

В директории [**./src/core**](https://github.com/EgorKo25/matchmaking_service/blob/main/src/core/) есть файл [**benchmark.py**](https://github.com/EgorKo25/matchmaking_service/blob/main/src/core/benchmark.py) он отрисовывает график по файлу, который генерируется в результате  
запуска функции **BenchmarkFindGroupForGraph** в файле [**./src/core/core_test.go**](https://github.com/EgorKo25/matchmaking_service/blob/main/src/core/core_test.go)

Функция **BenchmarkFindGroupForGraph** проводит исследование изменения скорости работы поиска группы для пользователя на 1, 10, 100, 1000, 10000, 100000, 1000000 пробах.
Согласно графику время растет линейно - **O(n)**.
### Тесты 

Также реализованы unit-тесты покрывающие основной функционал, для запуска всех тестов достаточно ввести команду:
```shell
go test ./...
```
в корне проекта 